sequenceDiagram
    actor Client
    actor Planificateur
    actor Transporteur
    participant Système
    participant BDD as Base de données
    
    Client->>Système: S'authentifier
    Système->>BDD: Vérifier identifiants
    BDD-->>Système: Confirmation authentification
    Système-->>Client: Accès autorisé
    
    Client->>Système: Créer commande (adresses, marchandises)
    Système->>BDD: Enregistrer commande
    BDD-->>Système: Confirmation enregistrement
    Système-->>Client: Confirmation création commande
    
    Planificateur->>Système: S'authentifier
    Système->>BDD: Vérifier identifiants
    BDD-->>Système: Confirmation authentification
    Système-->>Planificateur: Accès autorisé
    
    Planificateur->>Système: Consulter commandes en attente
    Système->>BDD: Récupérer commandes en attente
    BDD-->>Système: Liste des commandes
    Système-->>Planificateur: Affichage des commandes
    
    Planificateur->>Système: Demander optimisation itinéraire
    Système->>Système: Récupérer données trafic
    Système->>Système: Récupérer données météo
    Système->>Système: Calculer itinéraire optimal
    Système-->>Planificateur: Proposition d'itinéraire
    
    Planificateur->>Système: Affecter commande à transporteur
    Système->>BDD: Mettre à jour commande
    BDD-->>Système: Confirmation mise à jour
    
    Planificateur->>Système: Générer bon de livraison
    Système->>BDD: Créer bon de livraison
    BDD-->>Système: Confirmation création
    Système-->>Planificateur: Affichage bon de livraison
    
    Système->>Transporteur: Envoyer notification de mission
    Transporteur->>Système: S'authentifier
    Système->>BDD: Vérifier identifiants
    BDD-->>Système: Confirmation authentification
    Système-->>Transporteur: Accès autorisé
    
    Transporteur->>Système: Consulter mission et itinéraire
    Système->>BDD: Récupérer détails mission
    BDD-->>Système: Détails mission
    Système-->>Transporteur: Affichage mission et itinéraire
    
    Note over Transporteur,Système: Pendant la livraison
    
    Transporteur->>Système: Mettre à jour statut (en cours)
    Système->>BDD: Mettre à jour statut
    BDD-->>Système: Confirmation mise à jour
    Système->>Client: Envoyer notification
    
    alt Incident pendant livraison
        Transporteur->>Système: Notifier incident
        Système->>BDD: Enregistrer incident
        BDD-->>Système: Confirmation enregistrement
        Système->>Client: Notifier retard
        Système->>Planificateur: Notifier incident
    end
    
    Transporteur->>Système: Mettre à jour statut (livré)
    Système->>BDD: Mettre à jour statut
    BDD-->>Système: Confirmation mise à jour
    Système->>Client: Envoyer notification
    
    Client->>Système: Suivre commande
    Système->>BDD: Récupérer statut commande
    BDD-->>Système: Statut actuel
    Système-->>Client: Affichage statut livraison
    
    Client->>Système: Générer rapport
    Système->>BDD: Récupérer données commande
    BDD-->>Système: Données commande
    Système-->>Client: Affichage rapport
